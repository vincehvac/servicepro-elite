<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ServicePro Elite - Smart Field-Service Management for HVAC Pros</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --card-bg: rgba(255, 255, 255, 0.1);
            --card-border: rgba(255, 255, 255, 0.2);
            --text-primary: #ffffff;
            --text-secondary: rgba(255, 255, 255, 0.9);
            --success-color: #4ade80;
            --warning-color: #fbbf24;
            --danger-color: #ef4444;
        }
        
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; 
            background: var(--primary-gradient);
            min-height: 100vh; 
            color: var(--text-primary);
            overflow-x: hidden;
        }
        
        .container { 
            max-width: 1400px; 
            margin: 0 auto; 
            padding: 20px; 
        }
        
        /* Header with Role Selector */
        .header { 
            background: var(--primary-gradient);
            border-radius: 20px; 
            padding: 40px; 
            margin-bottom: 30px; 
            box-shadow: 0 20px 60px rgba(102, 126, 234, 0.3);
            text-align: center;
            border: 2px solid var(--card-border);
            position: relative;
        }
        
        .role-selector {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .role-selector label {
            font-size: 14px;
            font-weight: 600;
        }
        
        .role-selector select {
            padding: 8px 15px;
            border-radius: 8px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .role-selector select:focus {
            outline: none;
            border-color: white;
            background: rgba(255, 255, 255, 0.2);
        }
        
        .logo { 
            font-size: 48px; 
            font-weight: bold; 
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }
        
        .tagline { 
            font-size: 24px; 
            opacity: 0.9;
            margin-bottom: 20px;
        }
        
        .subtitle {
            font-size: 18px;
            opacity: 0.8;
            font-style: italic;
        }
        
        /* Customizable Widget Dashboard */
        .dashboard-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding: 15px;
            background: var(--card-bg);
            border-radius: 10px;
            border: 2px solid var(--card-border);
        }
        
        .dashboard-controls h3 {
            font-size: 20px;
        }
        
        .widget-controls {
            display: flex;
            gap: 10px;
        }
        
        .btn-control {
            padding: 8px 16px;
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 6px;
            color: white;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }
        
        .btn-control:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }
        
        /* Widget Grid System */
        .widget-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }
        
        .widget {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 25px;
            border: 2px solid var(--card-border);
            backdrop-filter: blur(10px);
            cursor: move;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .widget.dragging {
            opacity: 0.5;
            transform: scale(0.95);
        }
        
        .widget:hover {
            border-color: rgba(255, 255, 255, 0.4);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }
        
        .widget-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .widget-title {
            font-size: 18px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .widget-actions {
            display: flex;
            gap: 8px;
        }
        
        .widget-action-btn {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            padding: 4px 8px;
            border-radius: 4px;
            transition: background 0.3s;
        }
        
        .widget-action-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .widget-content {
            color: var(--text-secondary);
        }
        
        .widget-stat {
            font-size: 36px;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .widget-label {
            font-size: 14px;
            opacity: 0.8;
        }
        
        /* Predictive Analytics Section */
        .analytics-section {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            border: 2px solid var(--card-border);
        }
        
        .analytics-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .analytics-header h2 {
            font-size: 28px;
        }
        
        .analytics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        
        .analytics-card {
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .analytics-card h4 {
            font-size: 16px;
            margin-bottom: 10px;
            color: var(--success-color);
        }
        
        .analytics-value {
            font-size: 32px;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .analytics-trend {
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .trend-up { color: var(--success-color); }
        .trend-down { color: var(--danger-color); }
        
        .analytics-chart {
            margin-top: 15px;
            height: 60px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 6px;
            position: relative;
            overflow: hidden;
        }
        
        .chart-bar {
            position: absolute;
            bottom: 0;
            width: 8%;
            background: linear-gradient(to top, var(--success-color), rgba(74, 222, 128, 0.3));
            border-radius: 3px 3px 0 0;
            transition: height 0.3s;
        }
        
        /* AI Job Assignment Section */
        .ai-assignment {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            border: 2px solid var(--card-border);
        }
        
        .ai-assignment h2 {
            font-size: 28px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .assignment-factors {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .factor-card {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .factor-card h4 {
            font-size: 14px;
            margin-bottom: 8px;
            color: var(--success-color);
        }
        
        .factor-value {
            font-size: 20px;
            font-weight: bold;
        }
        
        /* Action Buttons */
        .action-section {
            text-align: center;
            margin: 50px 0;
        }
        
        .action-section h2 {
            font-size: 36px;
            margin-bottom: 30px;
        }
        
        .btn { 
            background: linear-gradient(135deg, #fff 0%, #f0f0f0 100%); 
            color: #667eea; 
            padding: 15px 35px; 
            border: none; 
            border-radius: 10px; 
            cursor: pointer; 
            font-size: 18px; 
            font-weight: 600;
            margin: 10px 5px; 
            transition: all 0.3s ease;
            display: inline-block;
            text-decoration: none;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }
        
        .btn:hover { 
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
        }
        
        .btn-large {
            padding: 20px 50px;
            font-size: 22px;
        }
        
        /* Contact Form */
        .contact-section { 
            background: var(--card-bg);
            border-radius: 20px; 
            padding: 40px; 
            margin: 40px 0; 
            border: 2px solid var(--card-border);
            backdrop-filter: blur(10px);
        }
        
        .contact-section h2 { 
            color: #fff; 
            margin-bottom: 20px; 
            font-size: 32px; 
            text-align: center; 
        }
        
        .form-group { 
            margin: 20px 0; 
        }
        
        .form-group label { 
            display: block; 
            margin-bottom: 8px; 
            font-weight: 500; 
        }
        
        .form-group input, 
        .form-group select, 
        .form-group textarea { 
            width: 100%; 
            padding: 15px; 
            border: 2px solid rgba(255, 255, 255, 0.3); 
            border-radius: 10px; 
            font-size: 16px; 
            background: rgba(255, 255, 255, 0.1);
            color: white;
            transition: border-color 0.3s;
        }
        
        .form-group input::placeholder,
        .form-group textarea::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }
        
        .form-group input:focus, 
        .form-group select:focus, 
        .form-group textarea:focus { 
            outline: none; 
            border-color: #fff; 
            background: rgba(255, 255, 255, 0.15);
        }
        
        .form-row { 
            display: grid; 
            grid-template-columns: 1fr 1fr; 
            gap: 20px; 
        }
        
        .success-message { 
            background: rgba(74, 222, 128, 0.2); 
            color: var(--success-color);
            padding: 20px; 
            border-radius: 10px; 
            margin: 20px 0; 
            display: none;
            border: 2px solid var(--success-color);
        }
        
        /* Responsive Design */
        @media (max-width: 1024px) {
            .widget-grid {
                grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            }
            
            .analytics-grid {
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            }
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header {
                padding: 30px 20px;
            }
            
            .role-selector {
                position: static;
                justify-content: center;
                margin-bottom: 20px;
            }
            
            .logo {
                font-size: 32px;
            }
            
            .tagline {
                font-size: 18px;
            }
            
            .subtitle {
                font-size: 14px;
            }
            
            .widget-grid {
                grid-template-columns: 1fr;
            }
            
            .analytics-grid {
                grid-template-columns: 1fr;
            }
            
            .assignment-factors {
                grid-template-columns: 1fr;
            }
            
            .form-row { 
                grid-template-columns: 1fr; 
            }
            
            .dashboard-controls {
                flex-direction: column;
                gap: 15px;
            }
            
            .widget-controls {
                width: 100%;
                justify-content: center;
            }
            
            .btn-large {
                padding: 15px 30px;
                font-size: 18px;
            }
        }
        
        @media (max-width: 480px) {
            .logo {
                font-size: 24px;
            }
            
            .tagline {
                font-size: 16px;
            }
            
            .action-section h2 {
                font-size: 24px;
            }
            
            .btn {
                padding: 12px 25px;
                font-size: 16px;
            }
        }
        
        /* Loading Animation */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Tooltip */
        .tooltip {
            position: relative;
            display: inline-block;
        }
        
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 200px;
            background-color: rgba(0, 0, 0, 0.9);
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 10px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -100px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 14px;
        }
        
        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }
    </style>
<script src="https://sites.super.myninja.ai/_assets/ninja-daytona-script.js"></script>
</head>
<body>
    <div class="container">
        <!-- Header with Role Selector -->
        <div class="header">
            <div class="role-selector">
                <label for="userRole">View As:</label>
                <select id="userRole" onchange="switchRole()">
                    <option value="manager">Manager</option>
                    <option value="dispatcher">Dispatcher</option>
                    <option value="technician">Technician</option>
                    <option value="admin">Admin</option>
                </select>
            </div>
            <div class="logo">‚ö° ServicePro Elite</div>
            <div class="tagline">Smart Field-Service Management for HVAC Pros</div>
            <div class="subtitle">"Automate 80% of your work ‚Äî dispatch, diagnose, and deliver like a pro."</div>
        </div>

        <!-- Dashboard Controls -->
        <div class="dashboard-controls">
            <h3>üìä Customizable Dashboard</h3>
            <div class="widget-controls">
                <button class="btn-control" onclick="resetWidgets()">üîÑ Reset Layout</button>
                <button class="btn-control" onclick="saveLayout()">üíæ Save Layout</button>
                <button class="btn-control" onclick="addWidget()">‚ûï Add Widget</button>
            </div>
        </div>

        <!-- Customizable Widget Grid -->
        <div class="widget-grid" id="widgetGrid">
            <!-- Widgets will be dynamically generated based on role -->
        </div>

        <!-- Predictive Analytics Section -->
        <div class="analytics-section">
            <div class="analytics-header">
                <h2>üîÆ Predictive Analytics</h2>
                <span class="tooltip">
                    ‚ÑπÔ∏è
                    <span class="tooltiptext">AI-powered forecasts based on historical data and trends</span>
                </span>
            </div>
            <div class="analytics-grid" id="analyticsGrid">
                <!-- Analytics cards will be generated dynamically -->
            </div>
        </div>

        <!-- AI Job Assignment -->
        <div class="ai-assignment">
            <h2>ü§ñ Enhanced AI Job Assignment</h2>
            <p style="opacity: 0.9; margin-bottom: 20px;">
                Our AI considers multiple factors to optimize job assignments:
            </p>
            <div class="assignment-factors">
                <div class="factor-card">
                    <h4>üìç Proximity</h4>
                    <p class="factor-value">Real-time GPS</p>
                    <p style="font-size: 12px; opacity: 0.8; margin-top: 5px;">Distance & travel time</p>
                </div>
                <div class="factor-card">
                    <h4>üéì Certifications</h4>
                    <p class="factor-value">Skill Match</p>
                    <p style="font-size: 12px; opacity: 0.8; margin-top: 5px;">Required licenses & training</p>
                </div>
                <div class="factor-card">
                    <h4>üìä Workload</h4>
                    <p class="factor-value">Balanced</p>
                    <p style="font-size: 12px; opacity: 0.8; margin-top: 5px;">Current job count</p>
                </div>
                <div class="factor-card">
                    <h4>üö¶ Traffic</h4>
                    <p class="factor-value">Live Data</p>
                    <p style="font-size: 12px; opacity: 0.8; margin-top: 5px;">Real-time conditions</p>
                </div>
                <div class="factor-card">
                    <h4>‚è∞ Availability</h4>
                    <p class="factor-value">Schedule</p>
                    <p style="font-size: 12px; opacity: 0.8; margin-top: 5px;">Working hours & breaks</p>
                </div>
                <div class="factor-card">
                    <h4>‚≠ê Performance</h4>
                    <p class="factor-value">Rating</p>
                    <p style="font-size: 12px; opacity: 0.8; margin-top: 5px;">Customer feedback</p>
                </div>
            </div>
        </div>

        <!-- Action Buttons -->
        <div class="action-section">
            <h2>Get Started Now</h2>
            <a href="app.html" class="btn btn-large">üöÄ Launch Dashboard</a>
            <a href="hvac-calculator.html" class="btn btn-large">üîß HVAC Calculator</a>
            <a href="mobile-tech.html" class="btn btn-large">üì± Mobile Tech App</a>
        </div>

        <!-- Contact Form -->
        <div class="contact-section">
            <h2>üìû Get Started with ServicePro Elite</h2>
            <p style="text-align: center; margin-bottom: 30px; opacity: 0.9;">
                Join the future of HVAC field service management
            </p>
            
            <form id="contactForm" onsubmit="handleContactSubmit(event)">
                <div class="form-row">
                    <div class="form-group">
                        <label for="firstName">First Name *</label>
                        <input type="text" id="firstName" name="firstName" required>
                    </div>
                    <div class="form-group">
                        <label for="lastName">Last Name *</label>
                        <input type="text" id="lastName" name="lastName" required>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="email">Email Address *</label>
                        <input type="email" id="email" name="email" required>
                    </div>
                    <div class="form-group">
                        <label for="phone">Phone Number *</label>
                        <input type="tel" id="phone" name="phone" required>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="company">Company Name</label>
                    <input type="text" id="company" name="company" placeholder="Your HVAC Company">
                </div>
                
                <div class="form-group">
                    <label for="serviceType">I'm Interested In</label>
                    <select id="serviceType" name="serviceType">
                        <option value="demo">Free Demo</option>
                        <option value="pricing">Pricing Information</option>
                        <option value="trial">Start Free Trial</option>
                        <option value="enterprise">Enterprise Solution</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="message">Tell Us About Your Business *</label>
                    <textarea id="message" name="message" rows="4" placeholder="Number of technicians, current challenges, goals..." required></textarea>
                </div>
                
                <div style="text-align: center;">
                    <button type="submit" class="btn btn-large">Send Message</button>
                </div>
            </form>
            
            <div id="successMessage" class="success-message">
                ‚úÖ Thank you! Your message has been sent. We'll contact you within 24 hours.
            </div>
        </div>

        <!-- Footer -->
        <div style="text-align: center; margin: 50px 0; opacity: 0.7;">
            <p>¬© 2025 ServicePro Elite - Smart Field-Service Management for HVAC Pros</p>
            <p style="margin-top: 10px;">Automate 80% of repetitive work. Empower your technicians. Impress your customers.</p>
        </div>
    </div>

    <script>
        // Role-based widget configurations
        const roleWidgets = {
            manager: [
                { id: 'revenue', title: 'üí∞ Revenue', type: 'stat', value: '$0', label: 'Monthly Revenue' },
                { id: 'jobs', title: 'üìã Active Jobs', type: 'stat', value: '0', label: 'In Progress' },
                { id: 'techs', title: 'üë• Technicians', type: 'stat', value: '0', label: 'On Duty' },
                { id: 'satisfaction', title: '‚≠ê Satisfaction', type: 'stat', value: '0%', label: 'Customer Rating' },
                { id: 'efficiency', title: 'üìä Efficiency', type: 'stat', value: '0%', label: 'Team Performance' },
                { id: 'forecast', title: 'üîÆ Revenue Forecast', type: 'chart', value: 'Next 30 days' }
            ],
            dispatcher: [
                { id: 'pending', title: '‚è≥ Pending Jobs', type: 'stat', value: '0', label: 'Awaiting Assignment' },
                { id: 'active', title: 'üöÄ Active Jobs', type: 'stat', value: '0', label: 'In Progress' },
                { id: 'techs', title: 'üë• Available Techs', type: 'stat', value: '0', label: 'Ready to Dispatch' },
                { id: 'urgent', title: 'üö® Urgent', type: 'stat', value: '0', label: 'High Priority' },
                { id: 'eta', title: '‚è±Ô∏è Avg ETA', type: 'stat', value: '0 min', label: 'Response Time' },
                { id: 'map', title: 'üó∫Ô∏è Live Map', type: 'info', value: 'Real-time tracking' }
            ],
            technician: [
                { id: 'today', title: 'üìÖ Today\'s Jobs', type: 'stat', value: '0', label: 'Scheduled' },
                { id: 'completed', title: '‚úÖ Completed', type: 'stat', value: '0', label: 'This Week' },
                { id: 'earnings', title: 'üíµ Earnings', type: 'stat', value: '$0', label: 'This Week' },
                { id: 'rating', title: '‚≠ê Your Rating', type: 'stat', value: '0.0', label: 'Customer Feedback' },
                { id: 'next', title: '‚û°Ô∏è Next Job', type: 'info', value: 'No jobs scheduled' },
                { id: 'tools', title: 'üîß Quick Tools', type: 'info', value: 'Calculator & Guides' }
            ],
            admin: [
                { id: 'users', title: 'üë• Total Users', type: 'stat', value: '0', label: 'Active Accounts' },
                { id: 'revenue', title: 'üí∞ Revenue', type: 'stat', value: '$0', label: 'This Month' },
                { id: 'jobs', title: 'üìã Total Jobs', type: 'stat', value: '0', label: 'All Time' },
                { id: 'growth', title: 'üìà Growth', type: 'stat', value: '0%', label: 'Month over Month' },
                { id: 'system', title: '‚öôÔ∏è System Health', type: 'stat', value: '100%', label: 'Uptime' },
                { id: 'storage', title: 'üíæ Storage', type: 'stat', value: '0 GB', label: 'Used' }
            ]
        };

        // Predictive analytics data
        const analyticsData = {
            manager: [
                { title: 'Technician Workload', value: 'Balanced', trend: 'up', trendValue: '+5%', description: 'Optimal distribution' },
                { title: 'Revenue Trend', value: '+12%', trend: 'up', trendValue: 'vs last month', description: 'Strong growth' },
                { title: 'Maintenance Needs', value: '3 Units', trend: 'neutral', trendValue: 'Next 7 days', description: 'Predicted failures' }
            ],
            dispatcher: [
                { title: 'Peak Hours', value: '2-4 PM', trend: 'neutral', trendValue: 'Today', description: 'Highest demand' },
                { title: 'Avg Response', value: '45 min', trend: 'down', trendValue: '-10 min', description: 'Improved efficiency' },
                { title: 'Job Completion', value: '94%', trend: 'up', trendValue: '+2%', description: 'On-time rate' }
            ],
            technician: [
                { title: 'Weekly Earnings', value: '$0', trend: 'up', trendValue: '+0%', description: 'Projected income' },
                { title: 'Job Efficiency', value: '0%', trend: 'up', trendValue: '+0%', description: 'Completion rate' },
                { title: 'Customer Rating', value: '0.0', trend: 'neutral', trendValue: 'Avg', description: 'Feedback score' }
            ],
            admin: [
                { title: 'User Growth', value: '+0%', trend: 'up', trendValue: 'This month', description: 'New signups' },
                { title: 'System Load', value: '0%', trend: 'neutral', trendValue: 'Current', description: 'Server capacity' },
                { title: 'Data Usage', value: '0 GB', trend: 'up', trendValue: '+0 GB', description: 'Storage growth' }
            ]
        };

        let currentRole = 'manager';
        let draggedElement = null;

        // Initialize dashboard
        function initDashboard() {
            loadSavedLayout();
            renderWidgets();
            renderAnalytics();
            setupDragAndDrop();
        }

        // Switch role view
        function switchRole() {
            currentRole = document.getElementById('userRole').value;
            renderWidgets();
            renderAnalytics();
        }

        // Render widgets based on role
        function renderWidgets() {
            const grid = document.getElementById('widgetGrid');
            const widgets = roleWidgets[currentRole];
            
            grid.innerHTML = '';
            
            widgets.forEach(widget => {
                const widgetEl = createWidget(widget);
                grid.appendChild(widgetEl);
            });
        }

        // Create widget element
        function createWidget(widget) {
            const div = document.createElement('div');
            div.className = 'widget';
            div.draggable = true;
            div.dataset.widgetId = widget.id;
            
            let content = '';
            if (widget.type === 'stat') {
                content = `
                    <div class="widget-stat">${widget.value}</div>
                    <div class="widget-label">${widget.label}</div>
                `;
            } else if (widget.type === 'chart') {
                content = `
                    <div class="widget-label">${widget.value}</div>
                    <div class="analytics-chart" id="chart-${widget.id}"></div>
                `;
            } else {
                content = `<div class="widget-label">${widget.value}</div>`;
            }
            
            div.innerHTML = `
                <div class="widget-header">
                    <div class="widget-title">${widget.title}</div>
                    <div class="widget-actions">
                        <button class="widget-action-btn" onclick="refreshWidget('${widget.id}')">üîÑ</button>
                        <button class="widget-action-btn" onclick="removeWidget('${widget.id}')">‚úï</button>
                    </div>
                </div>
                <div class="widget-content">
                    ${content}
                </div>
            `;
            
            return div;
        }

        // Render analytics
        function renderAnalytics() {
            const grid = document.getElementById('analyticsGrid');
            const analytics = analyticsData[currentRole];
            
            grid.innerHTML = '';
            
            analytics.forEach(item => {
                const card = document.createElement('div');
                card.className = 'analytics-card';
                
                const trendClass = item.trend === 'up' ? 'trend-up' : item.trend === 'down' ? 'trend-down' : '';
                const trendIcon = item.trend === 'up' ? '‚Üë' : item.trend === 'down' ? '‚Üì' : '‚Üí';
                
                card.innerHTML = `
                    <h4>${item.title}</h4>
                    <div class="analytics-value">${item.value}</div>
                    <div class="analytics-trend ${trendClass}">
                        ${trendIcon} ${item.trendValue}
                    </div>
                    <p style="font-size: 12px; opacity: 0.7; margin-top: 8px;">${item.description}</p>
                `;
                
                grid.appendChild(card);
            });
        }

        // Drag and drop functionality
        function setupDragAndDrop() {
            const grid = document.getElementById('widgetGrid');
            
            grid.addEventListener('dragstart', (e) => {
                if (e.target.classList.contains('widget')) {
                    draggedElement = e.target;
                    e.target.classList.add('dragging');
                }
            });
            
            grid.addEventListener('dragend', (e) => {
                if (e.target.classList.contains('widget')) {
                    e.target.classList.remove('dragging');
                }
            });
            
            grid.addEventListener('dragover', (e) => {
                e.preventDefault();
                const afterElement = getDragAfterElement(grid, e.clientY);
                const dragging = document.querySelector('.dragging');
                if (afterElement == null) {
                    grid.appendChild(dragging);
                } else {
                    grid.insertBefore(dragging, afterElement);
                }
            });
        }

        function getDragAfterElement(container, y) {
            const draggableElements = [...container.querySelectorAll('.widget:not(.dragging)')];
            
            return draggableElements.reduce((closest, child) => {
                const box = child.getBoundingClientRect();
                const offset = y - box.top - box.height / 2;
                if (offset < 0 && offset > closest.offset) {
                    return { offset: offset, element: child };
                } else {
                    return closest;
                }
            }, { offset: Number.NEGATIVE_INFINITY }).element;
        }

        // Widget actions
        function refreshWidget(widgetId) {
            console.log('Refreshing widget:', widgetId);
            // In production, this would fetch real data
        }

        function removeWidget(widgetId) {
            const widget = document.querySelector(`[data-widget-id="${widgetId}"]`);
            if (widget && confirm('Remove this widget?')) {
                widget.remove();
            }
        }

        function addWidget() {
            alert('Widget customization coming soon! You can drag and rearrange existing widgets.');
        }

        function resetWidgets() {
            if (confirm('Reset dashboard to default layout?')) {
                localStorage.removeItem('widgetLayout');
                renderWidgets();
            }
        }

        function saveLayout() {
            const widgets = document.querySelectorAll('.widget');
            const layout = Array.from(widgets).map(w => w.dataset.widgetId);
            localStorage.setItem('widgetLayout', JSON.stringify(layout));
            alert('Layout saved successfully!');
        }

        function loadSavedLayout() {
            const saved = localStorage.getItem('widgetLayout');
            if (saved) {
                // Layout loading logic would go here
                console.log('Loaded saved layout');
            }
        }

        // Contact form handler
        function handleContactSubmit(event) {
            event.preventDefault();
            
            const formData = {
                firstName: document.getElementById('firstName').value,
                lastName: document.getElementById('lastName').value,
                email: document.getElementById('email').value,
                phone: document.getElementById('phone').value,
                company: document.getElementById('company').value,
                serviceType: document.getElementById('serviceType').value,
                message: document.getElementById('message').value,
                timestamp: new Date().toISOString(),
                type: 'contact'
            };
            
            // Save to localStorage (CRM integration)
            let leads = JSON.parse(localStorage.getItem('servicepro_leads') || '[]');
            leads.push(formData);
            localStorage.setItem('servicepro_leads', JSON.stringify(leads));
            
            // Show success message
            document.getElementById('successMessage').style.display = 'block';
            
            // Reset form
            document.getElementById('contactForm').reset();
            
            // Hide success message after 5 seconds
            setTimeout(() => {
                document.getElementById('successMessage').style.display = 'none';
            }, 5000);
            
            console.log('Contact form submitted:', formData);
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', initDashboard);
    </script>
</body>
</html>